<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seller Dashboard - UI Ecommerce</title>
    <style>
        /* 1. Base Styling */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 0;
            color: #333;
        }

        /* 2. Navigation */
        nav {
            background-color: #343a40;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        nav a { color: #fff; text-decoration: none; margin-left: 15px; }
        nav a:hover { color: #ccc; }

        /* 3. Layout Grid */
        .dashboard-container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 1fr 2fr; /* Sidebar & Main Content */
            gap: 25px;
        }

        /* 4. Cards */
        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            padding: 25px;
            margin-bottom: 25px;
        }

        .card h2 { margin-top: 0; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; font-size: 1.2rem; }
        
        /* 5. Wallet Box */
        .wallet-box {
            background: linear-gradient(135deg, #28a745, #218838);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
        }
        .wallet-balance { font-size: 2rem; font-weight: bold; margin: 10px 0; }

        /* 6. Forms */
        form label { display: block; margin-top: 15px; font-weight: 500; }
        form input, form textarea {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
        }
        form button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            margin-top: 15px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
        }
        form button:hover { background-color: #0056b3; }

        /* 7. Tables (For Products & Orders) */
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { text-align: left; padding: 12px; border-bottom: 1px solid #eee; }
        th { background-color: #f8f9fa; color: #666; font-size: 0.9rem; }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        .status-pending { background-color: #fff3cd; color: #856404; }
        .status-completed { background-color: #d4edda; color: #155724; }
        
        .btn-action {
            padding: 5px 10px;
            font-size: 0.8rem;
            width: auto;
            margin: 0;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .dashboard-container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <nav>
        <div style="font-size: 1.2rem; font-weight: bold;">Seller Center</div>
        <div>
            <a href="/">Go to Shop</a>
            <a href="/logout" style="color: #ff6b6b;">Logout</a>
        </div>
    </nav>

    <div class="dashboard-container">
        
        <div class="sidebar">
            <div class="card">
                <h2>My Wallet</h2>
                <div class="wallet-box">
                    <div>Available Balance</div>
                    <div class="wallet-balance">₦<%= (user.wallet_balance || 0).toLocaleString() %></div>
                    <small>Withdrawals are processed weekly</small>
                </div>
                <a href="/ads/buy" style="display:block; text-align:center; color:#007bff; text-decoration:none;">Promote Items (Buy Ads)</a>
            </div>

            <div class="card">
                <h2>Payout Settings</h2>
                <p style="font-size:0.9rem; color:#666;">Enter your bank details to receive payments.</p>
                <form action="/seller/onboard" method="POST">
                    <input type="hidden" name="_csrf" value="<%= typeof csrfToken !== 'undefined' ? csrfToken : '' %>">
                    
                    <label>Bank Name</label>
                    <input type="text" name="bank_name" placeholder="e.g. GTBank" value="<%= user.bank_name || '' %>" required>

                    <label>Account Number</label>
                    <input type="text" name="account_number" value="<%= user.account_number || '' %>" required>

                    <label>Bank Code</label>
                    <input type="text" name="bank_code" placeholder="e.g. 058" value="<%= user.bank_code || '' %>" required>

                    <button type="submit">Save Details</button>
                </form>
            </div>
        </div>

        <div class="main-content">
            
            <div class="card">
                <h2>Add New Product</h2>
                <form action="/seller/add-product" method="POST">
                    <input type="hidden" name="_csrf" value="<%= typeof csrfToken !== 'undefined' ? csrfToken : '' %>">
                    
                    <div style="display: flex; gap: 15px;">
                        <div style="flex: 2;">
                            <label>Product Title</label>
                            <input type="text" name="title" required>
                        </div>
                        <div style="flex: 1;">
                            <label>Price (₦)</label>
                            <input type="number" name="price" required>
                        </div>
                    </div>

                    <label>Description</label>
                    <textarea name="description" rows="3" required></textarea>

                    <label>Image URL</label>
                    <input type="text" name="image" placeholder="https://...">

                    <button type="submit">Publish Product</button>
                </form>
            </div>

            <div class="card">
                <h2>Incoming Orders</h2>
                <% if (orders && orders.length > 0) { %>
                    <table>
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Item</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% orders.forEach(function(order) { %>
                                <tr>
                                    <td>#<%= order.id %></td>
                                    <td>Item #<%= order.product_id %></td>
                                    <td>₦<%= order.seller_amount %></td>
                                    <td>
                                        <span class="status-badge <%= order.status === 'completed' ? 'status-completed' : 'status-pending' %>">
                                            <%= order.status %>
                                        </span>
                                    </td>
                                    <td>
                                        <% if (!order.seller_confirmed) { %>
                                            <form action="/order/<%= order.id %>/confirm/seller" method="POST" style="margin:0;">
                                                <input type="hidden" name="_csrf" value="<%= typeof csrfToken !== 'undefined' ? csrfToken : '' %>">
                                                <button type="submit" class="btn-action">Confirm Sent</button>
                                            </form>
                                        <% } else { %>
                                            <span>Waiting for Buyer</span>
                                        <% } %>
                                    </td>
                                </tr>
                            <% }); %>
                        </tbody>
                    </table>
                <% } else { %>
                    <p style="text-align:center; color:#888; margin-top:20px;">No active orders yet.</p>
                <% } %>
            </div>

        </div>
    </div>

</body>
</html>